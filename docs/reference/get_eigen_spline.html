<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='Compute "eigenSplines" across a dataset to discover the best df for spline fitting.
Steps:

UV Scale the data.
Turn each VAR in (IND x TIME) and group all VAR in (IND+VAR x TIME) using get_eigen_spline_matrix.
Compute "eigen.splines" on the transposed table (TIME x IND+VAR).
Returns eigen$matrix = PCprojection x TIME and eigen$variance = variance explained for each PC.



'><title>Compute eigenSplines across a dataset — get_eigen_spline • santaR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute eigenSplines across a dataset — get_eigen_spline"><meta property="og:description" content='Compute "eigenSplines" across a dataset to discover the best df for spline fitting.
Steps:

UV Scale the data.
Turn each VAR in (IND x TIME) and group all VAR in (IND+VAR x TIME) using get_eigen_spline_matrix.
Compute "eigen.splines" on the transposed table (TIME x IND+VAR).
Returns eigen$matrix = PCprojection x TIME and eigen$variance = variance explained for each PC.



'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">santaR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/getting-started.html">Intro</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/getting-started.html">Getting started</a>
    <a class="dropdown-item" href="../articles/prepare-input-data.html">How to prepare input for santaR</a>
    <a class="dropdown-item" href="../articles/santaR-GUI.html">Graphical User Interface</a>
    <a class="dropdown-item" href="../articles/theoretical-background.html">santaR theoretical background</a>
    <a class="dropdown-item" href="../articles/selecting-optimal-df.html">Selecting an optimal number of degrees of freedom</a>
    <a class="dropdown-item" href="../articles/automated-command-line.html">Automated command line analysis</a>
    <a class="dropdown-item" href="../articles/plotting-options.html">Plotting options</a>
    <a class="dropdown-item" href="../articles/advanced-command-line-functions.html">Advanced command line functions</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/adwolfer/santaR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Compute eigenSplines across a dataset</h1>
      <small class="dont-index">Source: <a href="https://github.com/adwolfer/santaR/blob/HEAD/R/df_search.R" class="external-link"><code>R/df_search.R</code></a></small>
      <div class="d-none name"><code>get_eigen_spline.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute "eigenSplines" across a dataset to discover the best <em>df</em> for spline fitting.</p><div class="section">
<h3 id="steps-">Steps:<a class="anchor" aria-label="anchor" href="#steps-"></a></h3>
<p></p><ul><li><p>UV Scale the data.</p></li>
<li><p>Turn each VAR in (IND x TIME) and group all VAR in (IND+VAR x TIME) using <code><a href="get_eigen_spline_matrix.html">get_eigen_spline_matrix</a></code>.</p></li>
<li><p>Compute "eigen.splines" on the transposed table (TIME x IND+VAR).</p></li>
<li><p>Returns eigen$matrix = PCprojection x TIME and eigen$variance = variance explained for each PC.</p></li>
</ul></div>

    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_eigen_spline</span><span class="op">(</span></span>
<span>  <span class="va">inputData</span>,</span>
<span>  <span class="va">ind</span>,</span>
<span>  <span class="va">time</span>,</span>
<span>  nPC <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  scaling <span class="op">=</span> <span class="st">"scaling_UV"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"nipals"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  centering <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>inputData</dt>
<dd><p>Matrix of measurements with observations as rows and variables as columns.</p></dd>


<dt>ind</dt>
<dd><p>Vector of subject identifier (individual) corresponding to each measurement.</p></dd>


<dt>time</dt>
<dd><p>Vector of time corresponding to each measurement.</p></dd>


<dt>nPC</dt>
<dd><p>(int) Number of Principal Components to compute, if none given (<code>nPC=NA</code>) compute all PC (usually number TP-1 as there is 1PC less than the smallest dimension).</p></dd>


<dt>scaling</dt>
<dd><p><code>"scaling_UV"</code> or <code>"scaling_mean"</code> scaling across all samples for each variable. Default <code>"scaling_UV"</code>. Note: scaling takes place outside of the pcaMethods call, therefore <code>$model</code> will indicate "Data was NOT scaled before running PCA".</p></dd>


<dt>method</dt>
<dd><p>PCA method <code>"svd"</code> doesn't accept missing value. <code>"nipals"</code> can handle missing values. Default <code>"nipals"</code>.</p></dd>


<dt>verbose</dt>
<dd><p>If <code>TRUE</code> print the PCA summary. Default <code>TRUE</code>.</p></dd>


<dt>centering</dt>
<dd><p>If <code>TRUE</code> centering for PCA, needed to remove baseline levels of each pc (often PC1). Default <code>TRUE</code>.</p></dd>


<dt>ncores</dt>
<dd><p>(int) Number of cores to use for parallelisation of the grouping of all splines. Default 0 for no parallelisation.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list eigen: <code>eigen$matrix</code></p>
<p></p>
<p><code>data.frame</code> of eigenSplines values with PCprojection as row and TIME as column. <code>eigen$variance</code> Vector of variance explained for each PC. <code>eigen$model</code> resulting pcaMethods model. <code>eigen$countTP</code> Matrix of number of measurements for each unique timepoint (as row).</p>


<div class="section">
<h3 id="comments-">Comments:<a class="anchor" aria-label="anchor" href="#comments-"></a></h3>
<p></p><ul><li><p>CENTERING: Centering converts all the values to fluctuations around zero instead of around the mean of the variable measurements. Hereby, it adjusts for differences in the offset between high and low intensity variables. It is therefore used to focus on the fluctuating part of the data, and leaves only the relevant variation (being the variation between the observations) for analysis.</p></li>
<li><p>SCALING: Scaling methods are data pretreatment approaches that divide each variable by a factor -the scaling factor- which is different for each variable. They aim to adjust for the differences in fold differences between the various variables by converting the data into differences in values relative to the scaling factor. This often results in the inflation of small values, which can have an undesirable side effect as the influence of the measurement error -that is usually relatively large for small values- is increased as well.</p></li>
<li><p>UNIT VARIANCE SCALING: UV or Autoscaling, is commonly applied and uses the standard deviation as the scaling factor. After autoscaling, all variables have a standard deviation of one and therefore the data is analysed on the basis of correlations instead of covariances, as is the case with centering.</p></li>
<li><p>BEFORE PCA, centering must be applied on the matrix that will be submitted to PCA to remove "baseline" levels.</p></li>
</ul></div>


    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Graphical implementation with <code><a href="santaR_start_GUI.html">santaR_start_GUI</a></code></p>
<p>Other DFsearch: 
<code><a href="get_eigen_DF.html">get_eigen_DF</a>()</code>,
<code><a href="get_eigen_DFoverlay_list.html">get_eigen_DFoverlay_list</a>()</code>,
<code><a href="get_param_evolution.html">get_param_evolution</a>()</code>,
<code><a href="plot_nbTP_histogram.html">plot_nbTP_histogram</a>()</code>,
<code><a href="plot_param_evolution.html">plot_param_evolution</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## 7 measurements, 3 subjects, 4 unique time-points, 2 variables</span></span></span>
<span class="r-in"><span><span class="va">inputData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span> ,<span class="fl">10</span>,<span class="fl">11</span>,<span class="fl">12</span>,<span class="fl">13</span>,<span class="fl">14</span>,<span class="fl">15</span>,<span class="fl">16</span>,<span class="fl">17</span>,<span class="fl">18</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ind</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'ind_1'</span>,<span class="st">'ind_1'</span>,<span class="st">'ind_1'</span>,<span class="st">'ind_2'</span>,<span class="st">'ind_2'</span>,<span class="st">'ind_2'</span>,<span class="st">'ind_3'</span>,<span class="st">'ind_3'</span>,<span class="st">'ind_3'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">0</span>,<span class="fl">10</span>,<span class="fl">15</span>,<span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">get_eigen_spline</span><span class="op">(</span><span class="va">inputData</span>, <span class="va">ind</span>, <span class="va">time</span>, nPC<span class="op">=</span><span class="cn">NA</span>, scaling<span class="op">=</span><span class="st">"scaling_UV"</span>, method<span class="op">=</span><span class="st">"nipals"</span>,</span></span>
<span class="r-in"><span>                 verbose<span class="op">=</span><span class="cn">TRUE</span>, centering<span class="op">=</span><span class="cn">TRUE</span>, ncores<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nipals calculated PCA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Importance of component(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  PC1    PC2     PC3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R2            0.7113 0.2190 0.05261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative R2 0.7113 0.9303 0.98287</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> total time: 0.01 secs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              0          5        10         15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PC1 -1.7075707 -0.7066426 0.7075708  1.7066425</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PC2 -0.3415271  0.9669724 1.0944005 -0.4297013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PC3 -0.1764657 -0.5129981 0.5110671  0.1987611</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $variance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.71126702 0.21899068 0.05260949</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nipals calculated PCA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Importance of component(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  PC1    PC2     PC3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R2            0.7113 0.2190 0.05261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative R2 0.7113 0.9303 0.98287</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 	Variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 	Samples</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 	NAs ( 25 %)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 	Calculated component(s)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data was mean centered before running PCA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data was NOT scaled before running PCA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scores structure:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loadings structure:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $countTP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># nipals calculated PCA</span></span></span>
<span class="r-in"><span><span class="co"># Importance of component(s):</span></span></span>
<span class="r-in"><span><span class="co">#                  PC1    PC2     PC3</span></span></span>
<span class="r-in"><span><span class="co"># R2            0.7113 0.2190 0.05261</span></span></span>
<span class="r-in"><span><span class="co"># Cumulative R2 0.7113 0.9303 0.98287</span></span></span>
<span class="r-in"><span><span class="co"># total time: 0.12 secs</span></span></span>
<span class="r-in"><span><span class="co"># $matrix</span></span></span>
<span class="r-in"><span><span class="co">#              0          5        10         15</span></span></span>
<span class="r-in"><span><span class="co"># PC1 -1.7075707 -0.7066426 0.7075708  1.7066425</span></span></span>
<span class="r-in"><span><span class="co"># PC2 -0.3415271  0.9669724 1.0944005 -0.4297013</span></span></span>
<span class="r-in"><span><span class="co"># PC3 -0.1764657 -0.5129981 0.5110671  0.1987611</span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span><span class="co"># $variance</span></span></span>
<span class="r-in"><span><span class="co"># [1] 0.71126702 0.21899068 0.05260949</span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span><span class="co"># $model</span></span></span>
<span class="r-in"><span><span class="co"># nipals calculated PCA</span></span></span>
<span class="r-in"><span><span class="co"># Importance of component(s):</span></span></span>
<span class="r-in"><span><span class="co">#                  PC1    PC2     PC3</span></span></span>
<span class="r-in"><span><span class="co"># R2            0.7113 0.2190 0.05261</span></span></span>
<span class="r-in"><span><span class="co"># Cumulative R2 0.7113 0.9303 0.98287</span></span></span>
<span class="r-in"><span><span class="co"># 6   Variables</span></span></span>
<span class="r-in"><span><span class="co"># 4   Samples</span></span></span>
<span class="r-in"><span><span class="co"># 6   NAs ( 25 %)</span></span></span>
<span class="r-in"><span><span class="co"># 3   Calculated component(s)</span></span></span>
<span class="r-in"><span><span class="co"># Data was mean centered before running PCA </span></span></span>
<span class="r-in"><span><span class="co"># Data was NOT scaled before running PCA </span></span></span>
<span class="r-in"><span><span class="co"># Scores structure:</span></span></span>
<span class="r-in"><span><span class="co"># [1] 4 3</span></span></span>
<span class="r-in"><span><span class="co"># Loadings structure:</span></span></span>
<span class="r-in"><span><span class="co"># [1] 6 3</span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span><span class="co"># $countTP</span></span></span>
<span class="r-in"><span><span class="co">#   [,1]</span></span></span>
<span class="r-in"><span><span class="co"># 3    6</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Arnaud Wolfer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

