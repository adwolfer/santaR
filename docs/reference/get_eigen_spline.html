<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute eigenSplines across a dataset — get_eigen_spline • santaR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compute eigenSplines across a dataset — get_eigen_spline" />
<meta property="og:description" content="Compute &quot;eigenSplines&quot; across a dataset to discover the best df for spline fitting.Steps:

UV Scale the data.
Turn each VAR in (IND x TIME) and group all VAR in (IND+VAR x TIME) using get_eigen_spline_matrix.
Compute &quot;eigen.splines&quot; on the transposed table (TIME x IND+VAR).
Returns eigen$matrix = PCprojection x TIME and eigen$variance = variance explained for each PC.


" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">santaR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/getting-started.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/getting-started.html">Getting started</a>
    </li>
    <li>
      <a href="../articles/prepare-input-data.html">How to prepare input for santaR</a>
    </li>
    <li>
      <a href="../articles/santaR-GUI.html">Graphical User Interface</a>
    </li>
    <li>
      <a href="../articles/theoretical-background.html">santaR theoretical background</a>
    </li>
    <li>
      <a href="../articles/selecting-optimal-df.html">Selecting an optimal number of degrees of freedom</a>
    </li>
    <li>
      <a href="../articles/automated-command-line.html">Automated command line analysis</a>
    </li>
    <li>
      <a href="../articles/plotting-options.html">Plotting options</a>
    </li>
    <li>
      <a href="../articles/advanced-command-line-functions.html">Advanced command line functions</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/adwolfer/santaR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute eigenSplines across a dataset</h1>
    <small class="dont-index">Source: <a href='https://github.com/adwolfer/santaR/blob/master/R/df_search.R'><code>R/df_search.R</code></a></small>
    <div class="hidden name"><code>get_eigen_spline.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute "eigenSplines" across a dataset to discover the best <em>df</em> for spline fitting.</p><h3>Steps:</h3>
<p></p><ul>
<li><p>UV Scale the data.</p></li>
<li><p>Turn each VAR in (IND x TIME) and group all VAR in (IND+VAR x TIME) using <code><a href='get_eigen_spline_matrix.html'>get_eigen_spline_matrix</a></code>.</p></li>
<li><p>Compute "eigen.splines" on the transposed table (TIME x IND+VAR).</p></li>
<li><p>Returns eigen$matrix = PCprojection x TIME and eigen$variance = variance explained for each PC.</p></li>
</ul>


    </div>

    <pre class="usage"><span class='fu'>get_eigen_spline</span>(<span class='no'>inputData</span>, <span class='no'>ind</span>, <span class='no'>time</span>, <span class='kw'>nPC</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>scaling</span> <span class='kw'>=</span> <span class='st'>"scaling_UV"</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"nipals"</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>centering</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>ncores</span> <span class='kw'>=</span> <span class='fl'>0</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>inputData</th>
      <td><p>Matrix of measurements with observations as rows and variables as columns.</p></td>
    </tr>
    <tr>
      <th>ind</th>
      <td><p>Vector of subject identifier (individual) corresponding to each measurement.</p></td>
    </tr>
    <tr>
      <th>time</th>
      <td><p>Vector of time corresponding to each measurement.</p></td>
    </tr>
    <tr>
      <th>nPC</th>
      <td><p>(int) Number of Principal Components to compute, if none given (<code>nPC=NA</code>) compute all PC (usually number TP-1 as there is 1PC less than the smallest dimension).</p></td>
    </tr>
    <tr>
      <th>scaling</th>
      <td><p><code>"scaling_UV"</code> or <code>"scaling_mean"</code> scaling across all samples for each variable. Default <code>"scaling_UV"</code>. Note: scaling takes place outside of the pcaMethods call, therefore <code>$model</code> will indicate "Data was NOT scaled before running PCA".</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>PCA method <code>"svd"</code> doesn't accept missing value. <code>"nipals"</code> can handle missing values. Default <code>"nipals"</code>.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>If <code>TRUE</code> print the PCA summary. Default <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>centering</th>
      <td><p>If <code>TRUE</code> centering for PCA, needed to remove baseline levels of each pc (often PC1). Default <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>ncores</th>
      <td><p>(int) Number of cores to use for parallelisation of the grouping of all splines. Default 0 for no parallelisation.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list eigen: <code>eigen$matrix</code> <code>data.frame</code> of eigenSplines values with PCprojection as row and TIME as column. <code>eigen$variance</code> Vector of variance explained for each PC. <code>eigen$model</code> resulting pcaMethods model. <code>eigen$countTP</code> Matrix of number of measurements for each unique timepoint (as row).</p>
<h3>Comments:</h3>
<p></p><ul>
<li><p>CENTERING: Centering converts all the values to fluctuations around zero instead of around the mean of the variable measurements. Hereby, it adjusts for differences in the offset between high and low intensity variables. It is therefore used to focus on the fluctuating part of the data, and leaves only the relevant variation (being the variation between the observations) for analysis.</p></li>
<li><p>SCALING: Scaling methods are data pretreatment approaches that divide each variable by a factor -the scaling factor- which is different for each variable. They aim to adjust for the differences in fold differences between the various variables by converting the data into differences in values relative to the scaling factor. This often results in the inflation of small values, which can have an undesirable side effect as the influence of the measurement error -that is usually relatively large for small values- is increased as well.</p></li>
<li><p>UNIT VARIANCE SCALING: UV or Autoscaling, is commonly applied and uses the standard deviation as the scaling factor. After autoscaling, all variables have a standard deviation of one and therefore the data is analysed on the basis of correlations instead of covariances, as is the case with centering.</p></li>
<li><p>BEFORE PCA, centering must be applied on the matrix that will be submitted to PCA to remove "baseline" levels.</p></li>
</ul>


    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Graphical implementation with <code><a href='santaR_start_GUI.html'>santaR_start_GUI</a></code></p>
<p>Other DFsearch: <code><a href='get_eigen_DFoverlay_list.html'>get_eigen_DFoverlay_list</a></code>,
  <code><a href='get_eigen_DF.html'>get_eigen_DF</a></code>,
  <code><a href='get_param_evolution.html'>get_param_evolution</a></code>,
  <code><a href='plot_nbTP_histogram.html'>plot_nbTP_histogram</a></code>,
  <code><a href='plot_param_evolution.html'>plot_param_evolution</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## 7 measurements, 3 subjects, 4 unique time-points, 2 variables</span>
<span class='no'>inputData</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>4</span>,<span class='fl'>5</span>,<span class='fl'>6</span>,<span class='fl'>7</span>,<span class='fl'>8</span>,<span class='fl'>9</span> ,<span class='fl'>10</span>,<span class='fl'>11</span>,<span class='fl'>12</span>,<span class='fl'>13</span>,<span class='fl'>14</span>,<span class='fl'>15</span>,<span class='fl'>16</span>,<span class='fl'>17</span>,<span class='fl'>18</span>), <span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>2</span>)
<span class='no'>ind</span>  <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>'ind_1'</span>,<span class='st'>'ind_1'</span>,<span class='st'>'ind_1'</span>,<span class='st'>'ind_2'</span>,<span class='st'>'ind_2'</span>,<span class='st'>'ind_2'</span>,<span class='st'>'ind_3'</span>,<span class='st'>'ind_3'</span>,<span class='st'>'ind_3'</span>)
<span class='no'>time</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>5</span>,<span class='fl'>10</span>,<span class='fl'>0</span>,<span class='fl'>10</span>,<span class='fl'>15</span>,<span class='fl'>5</span>,<span class='fl'>10</span>,<span class='fl'>15</span>)
<span class='fu'>get_eigen_spline</span>(<span class='no'>inputData</span>, <span class='no'>ind</span>, <span class='no'>time</span>, <span class='kw'>nPC</span><span class='kw'>=</span><span class='fl'>NA</span>, <span class='kw'>scaling</span><span class='kw'>=</span><span class='st'>"scaling_UV"</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"nipals"</span>,
                 <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>centering</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>ncores</span><span class='kw'>=</span><span class='fl'>0</span>)</div><div class='output co'>#&gt; nipals calculated PCA
#&gt; Importance of component(s):
#&gt;                  PC1    PC2     PC3
#&gt; R2            0.7113 0.2190 0.05261
#&gt; Cumulative R2 0.7113 0.9303 0.98287</div><div class='output co'>#&gt; <span class='message'>total time: 0.01 secs</span></div><div class='output co'>#&gt; $matrix
#&gt;              0          5        10         15
#&gt; PC1 -1.7075707 -0.7066426 0.7075708  1.7066425
#&gt; PC2 -0.3415271  0.9669724 1.0944005 -0.4297013
#&gt; PC3 -0.1764657 -0.5129981 0.5110671  0.1987611
#&gt; 
#&gt; $variance
#&gt; [1] 0.71126702 0.21899068 0.05260949
#&gt; 
#&gt; $model
#&gt; nipals calculated PCA
#&gt; Importance of component(s):
#&gt;                  PC1    PC2     PC3
#&gt; R2            0.7113 0.2190 0.05261
#&gt; Cumulative R2 0.7113 0.9303 0.98287
#&gt; 6 	Variables
#&gt; 4 	Samples
#&gt; 6 	NAs ( 25 %)
#&gt; 3 	Calculated component(s)
#&gt; Data was mean centered before running PCA 
#&gt; Data was NOT scaled before running PCA 
#&gt; Scores structure:
#&gt; [1] 4 3
#&gt; Loadings structure:
#&gt; [1] 6 3
#&gt; 
#&gt; $countTP
#&gt;   [,1]
#&gt; 3    6
#&gt; </div><div class='input'># nipals calculated PCA
# Importance of component(s):
#                  PC1    PC2     PC3
# R2            0.7113 0.2190 0.05261
# Cumulative R2 0.7113 0.9303 0.98287
# total time: 0.12 secs
# $matrix
#              0          5        10         15
# PC1 -1.7075707 -0.7066426 0.7075708  1.7066425
# PC2 -0.3415271  0.9669724 1.0944005 -0.4297013
# PC3 -0.1764657 -0.5129981 0.5110671  0.1987611
# 
# $variance
# [1] 0.71126702 0.21899068 0.05260949
# 
# $model
# nipals calculated PCA
# Importance of component(s):
#                  PC1    PC2     PC3
# R2            0.7113 0.2190 0.05261
# Cumulative R2 0.7113 0.9303 0.98287
# 6 	Variables
# 4 	Samples
# 6 	NAs ( 25 %)
# 3 	Calculated component(s)
# Data was mean centered before running PCA 
# Data was NOT scaled before running PCA 
# Scores structure:
# [1] 4 3
# Loadings structure:
# [1] 6 3
# 
# $countTP
#   [,1]
# 3    6

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Arnaud Wolfer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


