<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Compute the optimal df and weighted-df using 5 spline fitting metric — get_eigen_DF • santaR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Compute the optimal df and weighted-df using 5 spline fitting metric — get_eigen_DF"><meta property="og:description" content="Compute the optimal degree of freedom (df) and weighted degree of freedom (wdf) using 5 fitting metrics (CV: Cross-Validation, GCV: Generalised Cross-Validation, AIC: Akaike Information Criterion, BIC: Bayesian Information Criterion, AICc: Akaike Information Criterion Corrected for small sample size) over all eigenSplines generated by get_eigen_spline.
The degree of freedom (df) is obtained by averaging the optimal df across each eigenSpline.
The weighted degree of freedom (wdf) is obtained by weighting the optimal df in each eigenSpline by the percentage of variance explained by each eigenSpline, before summing the optimal dfs (variance sums to 100%)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">santaR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/getting-started.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/getting-started.html">Getting started</a>
    </li>
    <li>
      <a href="../articles/prepare-input-data.html">How to prepare input for santaR</a>
    </li>
    <li>
      <a href="../articles/santaR-GUI.html">Graphical User Interface</a>
    </li>
    <li>
      <a href="../articles/theoretical-background.html">santaR theoretical background</a>
    </li>
    <li>
      <a href="../articles/selecting-optimal-df.html">Selecting an optimal number of degrees of freedom</a>
    </li>
    <li>
      <a href="../articles/automated-command-line.html">Automated command line analysis</a>
    </li>
    <li>
      <a href="../articles/plotting-options.html">Plotting options</a>
    </li>
    <li>
      <a href="../articles/advanced-command-line-functions.html">Advanced command line functions</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/adwolfer/santaR" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute the optimal df and weighted-df using 5 spline fitting metric</h1>
    <small class="dont-index">Source: <a href="https://github.com/adwolfer/santaR/blob/HEAD/R/df_search.R" class="external-link"><code>R/df_search.R</code></a></small>
    <div class="hidden name"><code>get_eigen_DF.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute the optimal degree of freedom (<em>df</em>) and weighted degree of freedom (<em>wdf</em>) using 5 fitting metrics (<em><strong>CV</strong>: Cross-Validation, <strong>GCV</strong>: Generalised Cross-Validation, <strong>AIC</strong>: Akaike Information Criterion, <strong>BIC</strong>: Bayesian Information Criterion, <strong>AICc</strong>: Akaike Information Criterion Corrected for small sample size</em>) over all eigenSplines generated by <code><a href="get_eigen_spline.html">get_eigen_spline</a></code>.
The degree of freedom (<em>df</em>) is obtained by averaging the optimal <em>df</em> across each eigenSpline.
The weighted degree of freedom (<em>wdf</em>) is obtained by weighting the optimal <em>df</em> in each eigenSpline by the percentage of variance explained by each eigenSpline, before summing the optimal <em>df</em>s (variance sums to 100%).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">get_eigen_DF</span><span class="op">(</span><span class="va">eigen</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>eigen</dt>
<dd><p>A list of eigenSpline parameters as generated by <code><a href="get_eigen_spline.html">get_eigen_spline</a></code>, containing <code>eigen$matrix</code>, <code>eigen$variance</code>, <code>eigen$model</code> and <code>eigen$countTP</code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list: <code>answer$df</code> a vector of optimum <em>df</em> by CV, GCV, AIC, BIC, AICc. <code>answer$wdf</code> a vector of weighted optimum <em>df</em> by CV, GCV, AIC, BIC, AICc.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Graphical implementation with <code><a href="santaR_start_GUI.html">santaR_start_GUI</a></code></p>
<p>Other DFsearch: 
<code><a href="get_eigen_DFoverlay_list.html">get_eigen_DFoverlay_list</a>()</code>,
<code><a href="get_eigen_spline.html">get_eigen_spline</a>()</code>,
<code><a href="get_param_evolution.html">get_param_evolution</a>()</code>,
<code><a href="plot_nbTP_histogram.html">plot_nbTP_histogram</a>()</code>,
<code><a href="plot_param_evolution.html">plot_param_evolution</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">## 8 subjects, 8 time-points, 3 variables</span></span>
<span class="r-in"><span class="va">inputData</span> <span class="op">&lt;-</span> <span class="va">acuteInflammation</span><span class="op">$</span><span class="va">data</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span class="r-in"><span class="va">ind</span>       <span class="op">&lt;-</span> <span class="va">acuteInflammation</span><span class="op">$</span><span class="va">meta</span><span class="op">$</span><span class="va">ind</span></span>
<span class="r-in"><span class="va">time</span>      <span class="op">&lt;-</span> <span class="va">acuteInflammation</span><span class="op">$</span><span class="va">meta</span><span class="op">$</span><span class="va">time</span></span>
<span class="r-in"><span class="va">eigen</span>     <span class="op">&lt;-</span> <span class="fu"><a href="get_eigen_spline.html">get_eigen_spline</a></span><span class="op">(</span><span class="va">inputData</span>, <span class="va">ind</span>, <span class="va">time</span>, nPC<span class="op">=</span><span class="cn">NA</span>, scaling<span class="op">=</span><span class="st">"scaling_UV"</span>,</span>
<span class="r-in">                              method<span class="op">=</span><span class="st">"nipals"</span>, verbose<span class="op">=</span><span class="cn">TRUE</span>, centering<span class="op">=</span><span class="cn">TRUE</span>, ncores<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nipals calculated PCA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Importance of component(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  PC1    PC2     PC3      PC4    PC5      PC6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R2            0.8924 0.0848 0.01055 0.006084 0.0038 0.002362</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cumulative R2 0.8924 0.9772 0.98775 0.993838 0.9976 1.000000</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> total time: 0.27 secs</span>
<span class="r-in"><span class="co"># nipals calculated PCA</span></span>
<span class="r-in"><span class="co"># Importance of component(s):</span></span>
<span class="r-in"><span class="co">#                  PC1    PC2     PC3      PC4    PC5      PC6</span></span>
<span class="r-in"><span class="co"># R2            0.8924 0.0848 0.01055 0.006084 0.0038 0.002362</span></span>
<span class="r-in"><span class="co"># Cumulative R2 0.8924 0.9772 0.98775 0.993838 0.9976 1.000000</span></span>
<span class="r-in"><span class="fu">get_eigen_DF</span><span class="op">(</span><span class="va">eigen</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $df</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       CV      GCV      AIC      BIC     AICc </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.362581 4.255487 3.031260 2.919159 2.172547 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $wdf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       CV      GCV      AIC      BIC     AICc </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.293130 2.085212 6.675608 6.671545 4.467724 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="co"># $df</span></span>
<span class="r-in"><span class="co">#       CV      GCV      AIC      BIC     AICc </span></span>
<span class="r-in"><span class="co"># 3.362581 4.255487 3.031260 2.919159 2.172547 </span></span>
<span class="r-in"><span class="co"># $wdf</span></span>
<span class="r-in"><span class="co">#       CV      GCV      AIC      BIC     AICc </span></span>
<span class="r-in"><span class="co"># 2.293130 2.085212 6.675608 6.671545 4.467724 </span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Arnaud Wolfer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

