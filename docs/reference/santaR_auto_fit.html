<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Automate all steps of santaR fitting, Confidence bands estimation and p-values calculation for one or multiple variables — santaR_auto_fit • santaR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Automate all steps of santaR fitting, Confidence bands estimation and p-values calculation for one or multiple variables — santaR_auto_fit"><meta property="og:description" content="santaR_auto_fit encompasses all the analytical steps for the detection of significantly altered time trajectories (input data preparation: get_ind_time_matrix, establishing group membership: get_grouping, spline modelling of individual and group time evolutions: santaR_fit, computation of group mean curve confidence bands: santaR_CBand, identification of significantly altered time trajectories: santaR_pvalue_dist and/or santaR_pvalue_fit). As santaR is an univariate approach, multiple variables can be processed independently, which santaR_auto_fit can execute in parallel over multiple CPU cores."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">santaR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/getting-started.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/getting-started.html">Getting started</a>
    </li>
    <li>
      <a href="../articles/prepare-input-data.html">How to prepare input for santaR</a>
    </li>
    <li>
      <a href="../articles/santaR-GUI.html">Graphical User Interface</a>
    </li>
    <li>
      <a href="../articles/theoretical-background.html">santaR theoretical background</a>
    </li>
    <li>
      <a href="../articles/selecting-optimal-df.html">Selecting an optimal number of degrees of freedom</a>
    </li>
    <li>
      <a href="../articles/automated-command-line.html">Automated command line analysis</a>
    </li>
    <li>
      <a href="../articles/plotting-options.html">Plotting options</a>
    </li>
    <li>
      <a href="../articles/advanced-command-line-functions.html">Advanced command line functions</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/adwolfer/santaR" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Automate all steps of santaR fitting, Confidence bands estimation and p-values calculation for one or multiple variables</h1>
    <small class="dont-index">Source: <a href="https://github.com/adwolfer/santaR/blob/HEAD/R/santaR_auto_fit.R" class="external-link"><code>R/santaR_auto_fit.R</code></a></small>
    <div class="hidden name"><code>santaR_auto_fit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>santaR_auto_fit</code> encompasses all the analytical steps for the detection of significantly altered time trajectories (<em>input data preparation: <code><a href="get_ind_time_matrix.html">get_ind_time_matrix</a></code>, establishing group membership: <code><a href="get_grouping.html">get_grouping</a></code>, spline modelling of individual and group time evolutions: <code><a href="santaR_fit.html">santaR_fit</a></code>, computation of group mean curve confidence bands: <code><a href="santaR_CBand.html">santaR_CBand</a></code>, identification of significantly altered time trajectories: <code><a href="santaR_pvalue_dist.html">santaR_pvalue_dist</a></code> and/or <code><a href="santaR_pvalue_fit.html">santaR_pvalue_fit</a></code></em>). As <em>santaR</em> is an univariate approach, multiple variables can be processed independently, which <code>santaR_auto_fit</code> can execute in parallel over multiple CPU cores.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">santaR_auto_fit</span><span class="op">(</span>
  <span class="va">inputData</span>,
  <span class="va">ind</span>,
  <span class="va">time</span>,
  group <span class="op">=</span> <span class="cn">NA</span>,
  <span class="va">df</span>,
  ncores <span class="op">=</span> <span class="fl">0</span>,
  CBand <span class="op">=</span> <span class="cn">TRUE</span>,
  pval.dist <span class="op">=</span> <span class="cn">TRUE</span>,
  pval.fit <span class="op">=</span> <span class="cn">FALSE</span>,
  nBoot <span class="op">=</span> <span class="fl">1000</span>,
  alpha <span class="op">=</span> <span class="fl">0.05</span>,
  nPerm <span class="op">=</span> <span class="fl">1000</span>,
  nStep <span class="op">=</span> <span class="fl">5000</span>,
  alphaPval <span class="op">=</span> <span class="fl">0.05</span>,
  forceParIndTimeMat <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>inputData</dt>
<dd><p><code>data.frame</code> of measurements with observations as rows and variables as columns.</p></dd>
<dt>ind</dt>
<dd><p>Vector of subject identifier (individual) corresponding to each measurement.</p></dd>
<dt>time</dt>
<dd><p>Vector of the time corresponding to each measurement.</p></dd>
<dt>group</dt>
<dd><p>NA or vector of group membership for each measurement. Default is NA for no groups.</p></dd>
<dt>df</dt>
<dd><p>(float) Degree of freedom to employ for fitting the individual and group mean <code><a href="https://rdrr.io/r/stats/smooth.spline.html" class="external-link">smooth.spline</a></code>.</p></dd>
<dt>ncores</dt>
<dd><p>(int) Number of cores to use for parallelisation. Default 0 for no parallelisation.</p></dd>
<dt>CBand</dt>
<dd><p>If TRUE calculate confidence bands for group mean curves. Default is TRUE.</p></dd>
<dt>pval.dist</dt>
<dd><p>If TRUE calculate <em>p</em>-value based on inter-group mean curve distance. Default is TRUE.</p></dd>
<dt>pval.fit</dt>
<dd><p>If TRUE calculate <em>p</em>-value based on group mean curve improvement in fit. Default is FALSE.</p></dd>
<dt>nBoot</dt>
<dd><p>(int) Number of bootstrapping rounds for confidence band calculation. Default 1000.</p></dd>
<dt>alpha</dt>
<dd><p>(float) Confidence <em>(0.05 for 95% Confidence Bands)</em>. Default 0.05.</p></dd>
<dt>nPerm</dt>
<dd><p>(int) Number of permutations for <em>p</em>-value calculation. Default 1000.</p></dd>
<dt>nStep</dt>
<dd><p>(int) Number of steps (granularity) employed for the calculation of the area between group mean curves (<em>p-value dist</em>). Default is 5000.</p></dd>
<dt>alphaPval</dt>
<dd><p>(float) Confidence Interval on the permuted <em>p</em>-value <em>(0.05 for 95% Confidence Interval)</em>. Default 0.05.</p></dd>
<dt>forceParIndTimeMat</dt>
<dd><p>If TRUE parallelise the preparation of input data by <code><a href="get_ind_time_matrix.html">get_ind_time_matrix</a></code>. Default is FALSE.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of <em>SANTAObj</em> corresponding to each variable's analysis result.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    
<div class="section">
<h3 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h3>
<p></p><ul><li><p>The calculation of confidence bands accounts for approximately a third of the time taken by <code>santaR_auto_fit</code>, while the identification of significantly altered time trajectories (either <code><a href="santaR_pvalue_dist.html">santaR_pvalue_dist</a></code> or <code><a href="santaR_pvalue_fit.html">santaR_pvalue_fit</a></code>) accounts for two third of the total time. The time taken by these steps increases linearly with the increase of their respective parameters: <code>nBoot</code> for confidence bands, <code>nPerm</code> and <code>nStep</code> for identification of significantly altered trajectories using <code><a href="santaR_pvalue_dist.html">santaR_pvalue_dist</a></code>, <code>nPerm</code> for <code><a href="santaR_pvalue_fit.html">santaR_pvalue_fit</a></code>. Default values of these parameters are optimised to balance the time taken with the precision of the value estimation; increasing <code>nPerm</code> can tighten the <em>p</em>-value confidence intervals.</p></li>
<li><p>If the parallelisation is activated (<em><code>ncores&gt;0</code></em>), the fit of spline models, the calculation of confidence bands on the group mean curves and the identification of altered trajectories are executed for multiple variables simultaneously. However the preparation of input data (<code><a href="get_ind_time_matrix.html">get_ind_time_matrix</a></code>) is not parallelised by default as the parallelisation overhead cost is superior to the time potentially gained for all but the most complex datasets. The parallelisation overhead (<em>instantiating worker nodes, duplicating and transferring inputs to the worker nodes, concatenating results</em>) typically equals around 2 seconds, while executing <code><a href="get_ind_time_matrix.html">get_ind_time_matrix</a></code> is usually a matter of millisecond for a single variable (<em>ex: 7 time-points, 24 individuals, 1 variable)</em>; the parallelisation overhead far exceeding the time needed to process all variables sequentially. If the number of individual trajectories (subjects), of time-points, or of variables is very large, <code>forceParIndTimeMat</code> enables the parallelisation of <code><a href="get_ind_time_matrix.html">get_ind_time_matrix</a></code>.</p></li>
</ul></div>

    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other AutoProcess: 
<code><a href="santaR_auto_summary.html">santaR_auto_summary</a>()</code>,
<code><a href="santaR_plot.html">santaR_plot</a>()</code>,
<code><a href="santaR_start_GUI.html">santaR_start_GUI</a>()</code></p>
<p>Other Analysis: 
<code><a href="get_grouping.html">get_grouping</a>()</code>,
<code><a href="get_ind_time_matrix.html">get_ind_time_matrix</a>()</code>,
<code><a href="santaR_CBand.html">santaR_CBand</a>()</code>,
<code><a href="santaR_auto_summary.html">santaR_auto_summary</a>()</code>,
<code><a href="santaR_fit.html">santaR_fit</a>()</code>,
<code><a href="santaR_plot.html">santaR_plot</a>()</code>,
<code><a href="santaR_pvalue_dist.html">santaR_pvalue_dist</a>()</code>,
<code><a href="santaR_pvalue_fit.html">santaR_pvalue_fit</a>()</code>,
<code><a href="santaR_start_GUI.html">santaR_start_GUI</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">## 2 variables, 56 measurements, 8 subjects, 7 unique time-points</span></span>
<span class="r-in"><span class="co">## Default parameter values decreased to ensure an execution &lt; 2 seconds</span></span>
<span class="r-in"><span class="va">inputData</span>     <span class="op">&lt;-</span> <span class="va">acuteInflammation</span><span class="op">$</span><span class="va">data</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span class="r-in"><span class="va">ind</span>           <span class="op">&lt;-</span> <span class="va">acuteInflammation</span><span class="op">$</span><span class="va">meta</span><span class="op">$</span><span class="va">ind</span></span>
<span class="r-in"><span class="va">time</span>          <span class="op">&lt;-</span> <span class="va">acuteInflammation</span><span class="op">$</span><span class="va">meta</span><span class="op">$</span><span class="va">time</span></span>
<span class="r-in"><span class="va">group</span>         <span class="op">&lt;-</span> <span class="va">acuteInflammation</span><span class="op">$</span><span class="va">meta</span><span class="op">$</span><span class="va">group</span></span>
<span class="r-in"><span class="va">SANTAObjList</span>  <span class="op">&lt;-</span> <span class="fu">santaR_auto_fit</span><span class="op">(</span><span class="va">inputData</span>, <span class="va">ind</span>, <span class="va">time</span>, <span class="va">group</span>, df<span class="op">=</span><span class="fl">5</span>, ncores<span class="op">=</span><span class="fl">0</span>, CBand<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span class="r-in">                                pval.dist<span class="op">=</span><span class="cn">TRUE</span>, nBoot<span class="op">=</span><span class="fl">100</span>, nPerm<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Input data generated: 0 secs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Spline fitted: 0.02 secs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ConfBands done: 0.3 secs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> p-val dist done: 0.35 secs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> total time: 0.68 secs</span>
<span class="r-in"><span class="co"># Input data generated: 0.02 secs</span></span>
<span class="r-in"><span class="co"># Spline fitted: 0.03 secs</span></span>
<span class="r-in"><span class="co"># ConfBands done: 0.53 secs</span></span>
<span class="r-in"><span class="co"># p-val dist done: 0.79 secs</span></span>
<span class="r-in"><span class="co"># total time: 1.37 secs</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">SANTAObjList</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-in"><span class="co"># [1] 2</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">SANTAObjList</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "var_1" "var_2"</span>
<span class="r-in"><span class="co"># [1] "var_1" "var_2"</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Arnaud Wolfer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

