<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Evaluate difference in group trajectories based on the comparison of model fit (F-test) between one and two groups — santaR_pvalue_fit • santaR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Evaluate difference in group trajectories based on the comparison of model fit (F-test) between one and two groups — santaR_pvalue_fit"><meta property="og:description" content="Evaluate the difference in group trajectories by executing a t-test based on the comparison of improvement in model fit (F-test) between fitting one group mean curve to all individuals and fitting two group mean curves. This between-class differential evolution test, evaluates whether fitting 2 group curves decreases the residuals compared to a single group mean curve. The statistic employed is defined as a quantification of evidence for differential evolution, with the larger the statistic the more differentially evolving the variable appears to be. Individual group membership is repeatedly randomly permuted to generate new random groups and group mean curves, then employed to compute a Null distribution of the statistic (improvement in model fit from one to two groups). The improvement in model fit for the real group membership is then compared to this Null distribution (of no group difference) and a p-value is computed. Adapted from Storey and al. 'Significance analysis of time course microarray experiments', PNAS, 2005 [1].
The p-value is calculated as (b+1)/(nPerm+1) as to not report a p-value=0 (which would give problem with FDR correction) and reduce type I error.
The p-value will vary depending on the random sampling. Therefore a confidence interval can be constructed using Wilson's interval which presents good properties for small number of trials and probabilities close to 0 or 1.

"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">santaR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/getting-started.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/getting-started.html">Getting started</a>
    </li>
    <li>
      <a href="../articles/prepare-input-data.html">How to prepare input for santaR</a>
    </li>
    <li>
      <a href="../articles/santaR-GUI.html">Graphical User Interface</a>
    </li>
    <li>
      <a href="../articles/theoretical-background.html">santaR theoretical background</a>
    </li>
    <li>
      <a href="../articles/selecting-optimal-df.html">Selecting an optimal number of degrees of freedom</a>
    </li>
    <li>
      <a href="../articles/automated-command-line.html">Automated command line analysis</a>
    </li>
    <li>
      <a href="../articles/plotting-options.html">Plotting options</a>
    </li>
    <li>
      <a href="../articles/advanced-command-line-functions.html">Advanced command line functions</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/adwolfer/santaR" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Evaluate difference in group trajectories based on the comparison of model fit (F-test) between one and two groups</h1>
    <small class="dont-index">Source: <a href="https://github.com/adwolfer/santaR/blob/HEAD/R/santaR_pvalue_fit.R" class="external-link"><code>R/santaR_pvalue_fit.R</code></a></small>
    <div class="hidden name"><code>santaR_pvalue_fit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Evaluate the difference in group trajectories by executing a t-test based on the comparison of improvement in model fit <em>(F-test)</em> between fitting one group mean curve to all individuals and fitting two group mean curves. This between-class differential evolution test, evaluates whether fitting 2 group curves decreases the residuals compared to a single group mean curve. The statistic employed is defined as a quantification of evidence for differential evolution, with the larger the statistic the more differentially evolving the variable appears to be. Individual group membership is repeatedly randomly permuted to generate new random groups and group mean curves, then employed to compute a <em>Null</em> distribution of the statistic (improvement in model fit from one to two groups). The improvement in model fit for the real group membership is then compared to this <em>Null</em> distribution <em>(of no group difference)</em> and a <em>p</em>-value is computed. Adapted from <cite>Storey and al. 'Significance analysis of time course microarray experiments', PNAS, 2005 [1]</cite>.</p><ul><li><p>The <em>p</em>-value is calculated as <code>(b+1)/(nPerm+1)</code> as to not report a <em>p</em>-value=0 (which would give problem with FDR correction) and reduce type I error.</p></li>
<li><p>The <em>p</em>-value will vary depending on the random sampling. Therefore a confidence interval can be constructed using Wilson's interval which presents good properties for small number of trials and probabilities close to 0 or 1.</p></li>
</ul></div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">santaR_pvalue_fit</span><span class="op">(</span><span class="va">SANTAObj</span>, nPerm <span class="op">=</span> <span class="fl">1000</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>SANTAObj</dt>
<dd><p>A fitted <em>SANTAObj</em> as generated by <code><a href="santaR_fit.html">santaR_fit</a></code>.</p></dd>
<dt>nPerm</dt>
<dd><p>(int) Number of permutations. Default 1000.</p></dd>
<dt>alpha</dt>
<dd><p>(float) Confidence Interval on the permuted <em>p</em>-value <em>(0.05 for 95% Confidence Interval)</em>. Default 0.05.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <em>SANTAObj</em> with added <em>p</em>-value fit and confidence interval on the <em>p</em>-value.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>[1] Storey, J. D., Xiao, W., Leek, J. T., Tompkins, R. G. &amp; Davis, R. W. Significance analysis of time course microarray experiments. <em>Proceedings of the National Academy of Sciences of the United States of America</em> <strong>102</strong>, 12837-42 (2005).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Comparison with constant model with <code><a href="santaR_pvalue_fit_within.html">santaR_pvalue_fit_within</a></code></p>
<p>Other Analysis: 
<code><a href="get_grouping.html">get_grouping</a>()</code>,
<code><a href="get_ind_time_matrix.html">get_ind_time_matrix</a>()</code>,
<code><a href="santaR_CBand.html">santaR_CBand</a>()</code>,
<code><a href="santaR_auto_fit.html">santaR_auto_fit</a>()</code>,
<code><a href="santaR_auto_summary.html">santaR_auto_summary</a>()</code>,
<code><a href="santaR_fit.html">santaR_fit</a>()</code>,
<code><a href="santaR_plot.html">santaR_plot</a>()</code>,
<code><a href="santaR_pvalue_dist.html">santaR_pvalue_dist</a>()</code>,
<code><a href="santaR_start_GUI.html">santaR_start_GUI</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">## 56 measurements, 8 subjects, 7 unique time-points</span></span>
<span class="r-in"><span class="co">## Default parameter values decreased to ensure an execution &lt; 2 seconds</span></span>
<span class="r-in"><span class="va">Yi</span>          <span class="op">&lt;-</span> <span class="va">acuteInflammation</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">var_3</span></span>
<span class="r-in"><span class="va">ind</span>         <span class="op">&lt;-</span> <span class="va">acuteInflammation</span><span class="op">$</span><span class="va">meta</span><span class="op">$</span><span class="va">ind</span></span>
<span class="r-in"><span class="va">time</span>        <span class="op">&lt;-</span> <span class="va">acuteInflammation</span><span class="op">$</span><span class="va">meta</span><span class="op">$</span><span class="va">time</span></span>
<span class="r-in"><span class="va">group</span>       <span class="op">&lt;-</span> <span class="va">acuteInflammation</span><span class="op">$</span><span class="va">meta</span><span class="op">$</span><span class="va">group</span></span>
<span class="r-in"><span class="va">grouping</span>    <span class="op">&lt;-</span> <span class="fu"><a href="get_grouping.html">get_grouping</a></span><span class="op">(</span><span class="va">ind</span>, <span class="va">group</span><span class="op">)</span></span>
<span class="r-in"><span class="va">inputMatrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_ind_time_matrix.html">get_ind_time_matrix</a></span><span class="op">(</span><span class="va">Yi</span>, <span class="va">ind</span>, <span class="va">time</span><span class="op">)</span></span>
<span class="r-in"><span class="va">SANTAObj</span>    <span class="op">&lt;-</span> <span class="fu"><a href="santaR_fit.html">santaR_fit</a></span><span class="op">(</span><span class="va">inputMatrix</span>, df<span class="op">=</span><span class="fl">5</span>, grouping<span class="op">=</span><span class="va">grouping</span>, verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="va">SANTAObj</span>    <span class="op">&lt;-</span> <span class="fu">santaR_pvalue_fit</span><span class="op">(</span><span class="va">SANTAObj</span>, nPerm<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Arnaud Wolfer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

