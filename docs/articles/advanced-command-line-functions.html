<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced command line functions • santaR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Advanced command line functions">
<meta property="og:description" content="santaR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">santaR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/getting-started.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/getting-started.html">Getting started</a>
    </li>
    <li>
      <a href="../articles/prepare-input-data.html">How to prepare input for santaR</a>
    </li>
    <li>
      <a href="../articles/santaR-GUI.html">Graphical User Interface</a>
    </li>
    <li>
      <a href="../articles/theoretical-background.html">santaR theoretical background</a>
    </li>
    <li>
      <a href="../articles/selecting-optimal-df.html">Selecting an optimal number of degrees of freedom</a>
    </li>
    <li>
      <a href="../articles/automated-command-line.html">Automated command line analysis</a>
    </li>
    <li>
      <a href="../articles/plotting-options.html">Plotting options</a>
    </li>
    <li>
      <a href="../articles/advanced-command-line-functions.html">Advanced command line functions</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/adwolfer/santaR" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Advanced command line functions</h1>
                        <h4 data-toc-skip class="author">Arnaud
Wolfer</h4>
            
            <h4 data-toc-skip class="date">2019-10-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/adwolfer/santaR/blob/HEAD/vignettes/advanced-command-line-functions.Rmd" class="external-link"><code>vignettes/advanced-command-line-functions.Rmd</code></a></small>
      <div class="hidden name"><code>advanced-command-line-functions.Rmd</code></div>

    </div>

    
    
<p>While the following vignette details all command line functions
available in <code>santaR</code> for reference and potential development
work, these are not expected to be used on a day-to-day basis (more
details are available in each functions help page).</p>
<p>To analyse time-series data, refered to the <a href="santaR-GUI.pdf">graphical user interface</a> or the <a href="automated-command-line.html">automated command line functions</a>
which implement these functions.</p>
<p>This vignette will detail the following underlying functions:</p>
<ul>
<li>Preparing input data</li>
<li>DF search functions</li>
<li>Fitting, Confidence bands and plotting</li>
<li>P-values calculation</li>
</ul>
<div class="section level2">
<h2 id="preparing-input-data">Preparing input data<a class="anchor" aria-label="anchor" href="#preparing-input-data"></a>
</h2>
<p>As <code>santaR</code> is an univariate approach, this vignette will
use one variable from the acute inflammation dataset detailed in <a href="prepare-input-data.html">How to prepare input data for
santaR</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/adwolfer/santaR" class="external-link">santaR</a></span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## This is santaR version 1.2.3</span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># data (keep the 3rd variable)</span>
<span class="va">var1_data</span> <span class="op">&lt;-</span> <span class="va">acuteInflammation</span><span class="op">$</span><span class="va">data</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>
<span class="co"># metadata (common to all variables)</span>
<span class="va">var1_meta</span> <span class="op">&lt;-</span> <span class="va">acuteInflammation</span><span class="op">$</span><span class="va">meta</span>

<span class="co"># 7 unique time-points</span>
<span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">var1_meta</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1]  0  4  8 12 24 48 72</span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 8 individuals</span>
<span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">var1_meta</span><span class="op">$</span><span class="va">ind</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "ind_1" "ind_2" "ind_3" "ind_4" "ind_5" "ind_6" "ind_7" "ind_8"</span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 2 groups</span>
<span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">var1_meta</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "Group1" "Group2"</span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 72 measurements for the given variable</span>
<span class="va">var1_data</span></code></pre></div>
<pre><code><span class="co">##  [1] -0.21787887 -0.21787887 -0.51159424 -0.51159424 -0.39686603 -0.39686603</span>
<span class="co">##  [7] -0.36399116 -0.36399116  0.91102691  4.19746095 -0.01893874  0.08296167</span>
<span class="co">## [13]  0.03205536  1.36463826  0.45089171  1.85844915  0.58499815 -0.08218860</span>
<span class="co">## [19] -0.29144117 -0.73976352 -0.04776568 -0.52139013  0.32184021 -0.41087558</span>
<span class="co">## [25]  1.62075258 -0.02869199  0.40496659 -1.03962428  0.43082440 -0.76250288</span>
<span class="co">## [31]  0.87155065 -0.48644857  0.78381065 -1.03962428 -0.19688610 -1.03962428</span>
<span class="co">## [37]  0.02465099 -1.03962428  0.33945976 -1.03962428  0.49869622 -0.76358141</span>
<span class="co">## [43] -0.29114335 -1.03962428  0.05743940 -1.03962428  0.36979758 -1.03962428</span>
<span class="co">## [49]  2.34452908 -0.85939701 -0.07503976 -1.03962428  0.58606071 -1.03962428</span>
<span class="co">## [55]  1.85572115 -1.03962428</span></code></pre>
<p>The first step is to generate the input matrix by converting the
vector of observation (<em>y</em> response for the variable at one
time-point for one individual) into a matrix IND (<em>row</em>) x TIME
(<em>column</em>) using <code><a href="../reference/get_ind_time_matrix.html">get_ind_time_matrix()</a></code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">var1_input</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ind_time_matrix.html">get_ind_time_matrix</a></span><span class="op">(</span> Yi<span class="op">=</span><span class="va">var1_data</span>, ind<span class="op">=</span><span class="va">var1_meta</span><span class="op">$</span><span class="va">ind</span>, time<span class="op">=</span><span class="va">var1_meta</span><span class="op">$</span><span class="va">time</span><span class="op">)</span>
<span class="va">var1_input</span></code></pre></div>
<table class="table">
<colgroup>
<col width="13%">
<col width="11%">
<col width="12%">
<col width="12%">
<col width="12%">
<col width="11%">
<col width="11%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">0</th>
<th align="center">4</th>
<th align="center">8</th>
<th align="center">12</th>
<th align="center">24</th>
<th align="center">48</th>
<th align="center">72</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>ind_1</strong></td>
<td align="center">-0.2179</td>
<td align="center">0.911</td>
<td align="center">0.585</td>
<td align="center">1.621</td>
<td align="center">0.7838</td>
<td align="center">0.4987</td>
<td align="center">2.345</td>
</tr>
<tr class="even">
<td align="center"><strong>ind_2</strong></td>
<td align="center">-0.2179</td>
<td align="center">4.197</td>
<td align="center">-0.08219</td>
<td align="center">-0.02869</td>
<td align="center">-1.04</td>
<td align="center">-0.7636</td>
<td align="center">-0.8594</td>
</tr>
<tr class="odd">
<td align="center"><strong>ind_3</strong></td>
<td align="center">-0.5116</td>
<td align="center">-0.01894</td>
<td align="center">-0.2914</td>
<td align="center">0.405</td>
<td align="center">-0.1969</td>
<td align="center">-0.2911</td>
<td align="center">-0.07504</td>
</tr>
<tr class="even">
<td align="center"><strong>ind_4</strong></td>
<td align="center">-0.5116</td>
<td align="center">0.08296</td>
<td align="center">-0.7398</td>
<td align="center">-1.04</td>
<td align="center">-1.04</td>
<td align="center">-1.04</td>
<td align="center">-1.04</td>
</tr>
<tr class="odd">
<td align="center"><strong>ind_5</strong></td>
<td align="center">-0.3969</td>
<td align="center">0.03206</td>
<td align="center">-0.04777</td>
<td align="center">0.4308</td>
<td align="center">0.02465</td>
<td align="center">0.05744</td>
<td align="center">0.5861</td>
</tr>
<tr class="even">
<td align="center"><strong>ind_6</strong></td>
<td align="center">-0.3969</td>
<td align="center">1.365</td>
<td align="center">-0.5214</td>
<td align="center">-0.7625</td>
<td align="center">-1.04</td>
<td align="center">-1.04</td>
<td align="center">-1.04</td>
</tr>
<tr class="odd">
<td align="center"><strong>ind_7</strong></td>
<td align="center">-0.364</td>
<td align="center">0.4509</td>
<td align="center">0.3218</td>
<td align="center">0.8716</td>
<td align="center">0.3395</td>
<td align="center">0.3698</td>
<td align="center">1.856</td>
</tr>
<tr class="even">
<td align="center"><strong>ind_8</strong></td>
<td align="center">-0.364</td>
<td align="center">1.858</td>
<td align="center">-0.4109</td>
<td align="center">-0.4864</td>
<td align="center">-1.04</td>
<td align="center">-1.04</td>
<td align="center">-1.04</td>
</tr>
</tbody>
</table>
<p>In order to compare 2 groups, it is necessary to create a grouping
matrix that list group membership for all individuals using
<code><a href="../reference/get_grouping.html">get_grouping()</a></code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">var1_group</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_grouping.html">get_grouping</a></span><span class="op">(</span> ind<span class="op">=</span><span class="va">var1_meta</span><span class="op">$</span><span class="va">ind</span>, group<span class="op">=</span><span class="va">var1_meta</span><span class="op">$</span><span class="va">group</span><span class="op">)</span>
<span class="va">var1_group</span></code></pre></div>
<table style="width:24%;" class="table">
<colgroup>
<col width="11%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="center">ind</th>
<th align="center">group</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">ind_1</td>
<td align="center">Group1</td>
</tr>
<tr class="even">
<td align="center">ind_2</td>
<td align="center">Group2</td>
</tr>
<tr class="odd">
<td align="center">ind_3</td>
<td align="center">Group1</td>
</tr>
<tr class="even">
<td align="center">ind_4</td>
<td align="center">Group2</td>
</tr>
<tr class="odd">
<td align="center">ind_5</td>
<td align="center">Group1</td>
</tr>
<tr class="even">
<td align="center">ind_6</td>
<td align="center">Group2</td>
</tr>
<tr class="odd">
<td align="center">ind_7</td>
<td align="center">Group1</td>
</tr>
<tr class="even">
<td align="center">ind_8</td>
<td align="center">Group2</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="df-search-functions">DF search functions<a class="anchor" aria-label="anchor" href="#df-search-functions"></a>
</h2>
<p>The degree of freedom (<em>df</em>) is the parameter that controls
how closely each individual’s time-trajectory fit eachs data point,
balancing the fitting of the raw data and the smoothing of measurements
errors. An optimal <em>df</em> value ensures that the spline is not
overfitted or underfitted on the measurments. The degree of freedom
should be established once for a dataset as it is a factor of
‘complexity’ of the time-trajectories under study, but does not change
with different variables (same metadata, number of time-points,…)</p>
<p>Refer to <a href="theoretical-background.html">santaR theoretical
background</a> and <a href="selecting-optimal-df.html">Selecting an
optimal number of degrees of freedom</a> for more details on <em>df</em>
and an intuitive approach for its selection.</p>
<p>In order to assist in the selection of an optimal <em>df</em> and
visualise its impact, the following functions:</p>
<ul>
<li>extract the eigen-splines across all time-trajectories of all
individuals and all variables</li>
<li>provide metrics to select the <em>df</em> that gives the best fit on
the eigen-splines (as a guide value for the whole dataset)</li>
</ul>
<p>First we extract the eigen-splines across the whole dataset using
<code><a href="../reference/get_eigen_spline.html">get_eigen_spline()</a></code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">var_eigen</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_eigen_spline.html">get_eigen_spline</a></span><span class="op">(</span> inputData<span class="op">=</span><span class="va">acuteInflammation</span><span class="op">$</span><span class="va">data</span>, ind<span class="op">=</span><span class="va">acuteInflammation</span><span class="op">$</span><span class="va">meta</span><span class="op">$</span><span class="va">ind</span>, time<span class="op">=</span><span class="va">acuteInflammation</span><span class="op">$</span><span class="va">meta</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## nipals calculated PCA</span>
<span class="co">## Importance of component(s):</span>
<span class="co">##                  PC1    PC2     PC3     PC4     PC5      PC6</span>
<span class="co">## R2            0.8281 0.0679 0.05191 0.02942 0.01436 0.008339</span>
<span class="co">## Cumulative R2 0.8281 0.8960 0.94788 0.97731 0.99166 1.000000</span></code></pre>
<pre><code><span class="co">## total time: 0.3 secs</span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The projection of each eigen-spline at each time-point:</span>
<span class="va">var_eigen</span><span class="op">$</span><span class="va">matrix</span></code></pre></div>
<table class="table">
<colgroup>
<col width="12%">
<col width="11%">
<col width="13%">
<col width="12%">
<col width="12%">
<col width="12%">
<col width="12%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">0</th>
<th align="center">4</th>
<th align="center">8</th>
<th align="center">12</th>
<th align="center">24</th>
<th align="center">48</th>
<th align="center">72</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>PC1</strong></td>
<td align="center">5.933</td>
<td align="center">-24</td>
<td align="center">-2.723</td>
<td align="center">2.045</td>
<td align="center">6.146</td>
<td align="center">6.049</td>
<td align="center">6.546</td>
</tr>
<tr class="even">
<td align="center"><strong>PC2</strong></td>
<td align="center">-4.34</td>
<td align="center">0.5412</td>
<td align="center">-2.18</td>
<td align="center">1.551</td>
<td align="center">-0.1612</td>
<td align="center">-1.158</td>
<td align="center">5.746</td>
</tr>
<tr class="odd">
<td align="center"><strong>PC3</strong></td>
<td align="center">-3.195</td>
<td align="center">-1.782</td>
<td align="center">5.305</td>
<td align="center">1.726</td>
<td align="center">-0.1319</td>
<td align="center">-1.014</td>
<td align="center">-0.9077</td>
</tr>
<tr class="even">
<td align="center"><strong>PC4</strong></td>
<td align="center">0.4109</td>
<td align="center">-0.09695</td>
<td align="center">-1.724</td>
<td align="center">4.28</td>
<td align="center">0.1921</td>
<td align="center">-1.313</td>
<td align="center">-1.749</td>
</tr>
<tr class="odd">
<td align="center"><strong>PC5</strong></td>
<td align="center">-1.198</td>
<td align="center">0.2399</td>
<td align="center">-0.5312</td>
<td align="center">-0.636</td>
<td align="center">3.136</td>
<td align="center">-0.1187</td>
<td align="center">-0.8928</td>
</tr>
<tr class="even">
<td align="center"><strong>PC6</strong></td>
<td align="center">1.094</td>
<td align="center">-0.07218</td>
<td align="center">0.4487</td>
<td align="center">-0.3782</td>
<td align="center">0.5242</td>
<td align="center">-2.278</td>
<td align="center">0.6614</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The variance explained by each eigen-spline</span>
<span class="va">var_eigen</span><span class="op">$</span><span class="va">variance</span></code></pre></div>
<pre><code><span class="co">## [1] 0.828073142 0.067899396 0.051910368 0.029422712 0.014355448 0.008338933</span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># PCA summary</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">var_eigen</span><span class="op">$</span><span class="va">model</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## nipals calculated PCA</span>
<span class="co">## Importance of component(s):</span>
<span class="co">##                  PC1    PC2     PC3     PC4     PC5      PC6</span>
<span class="co">## R2            0.8281 0.0679 0.05191 0.02942 0.01436 0.008339</span>
<span class="co">## Cumulative R2 0.8281 0.8960 0.94788 0.97731 0.99166 1.000000</span></code></pre>
<p>It is then possible to estimate the <em>df</em> corresponding to the
minimisation of a metric (penalised_residuals cross-validated,
penalised_residuals general cross-validation, AIC, BIC or AICc) using
<code><a href="../reference/get_eigen_DF.html">get_eigen_DF()</a></code>. The best <em>df</em> can either be averaged
over all eigen-splines <code>df</code> or weighted by the variance
explained by each eigen-spline <code>wdf</code>:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The projection of each eigen-spline at each time-point:</span>
<span class="fu"><a href="../reference/get_eigen_DF.html">get_eigen_DF</a></span><span class="op">(</span><span class="va">var_eigen</span><span class="op">)</span>

<span class="co"># $df</span></code></pre></div>
<table style="width:56%;" class="table">
<colgroup>
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="center">CV</th>
<th align="center">GCV</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">AICc</th>
</tr></thead>
<tbody><tr class="odd">
<td align="center">2.712</td>
<td align="center">3.298</td>
<td align="center">6.289</td>
<td align="center">6.298</td>
<td align="center">3.499</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># $wdf</span></code></pre></div>
<table style="width:56%;" class="table">
<colgroup>
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="center">CV</th>
<th align="center">GCV</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">AICc</th>
</tr></thead>
<tbody><tr class="odd">
<td align="center">2.181</td>
<td align="center">2.095</td>
<td align="center">6.943</td>
<td align="center">6.944</td>
<td align="center">5.55</td>
</tr></tbody>
</table>
<p>The evolution of these metrics (<em>y</em>) depending on <em>df</em>
(<em>x</em>) can be plotted for each eigen-spline using
<code><a href="../reference/get_param_evolution.html">get_param_evolution()</a></code> and
<code><a href="../reference/plot_param_evolution.html">plot_param_evolution()</a></code>:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span>

<span class="co"># generate all the parameter values across df</span>
<span class="va">var_eigen_paramEvo</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_param_evolution.html">get_param_evolution</a></span><span class="op">(</span><span class="va">var_eigen</span>, step<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span>

<span class="co"># plot the metric evolution</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">arrangeGrob</a></span><span class="op">(</span>grobs<span class="op">=</span><span class="fu"><a href="../reference/plot_param_evolution.html">plot_param_evolution</a></span><span class="op">(</span><span class="va">var_eigen_paramEvo</span>, scaled<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="advanced-command-line-functions_files/figure-html/unnamed-chunk-14-1.png" width="560"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Scale the metrics for each eigen-spline between 0 and 1</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">arrangeGrob</a></span><span class="op">(</span>grobs<span class="op">=</span><span class="fu"><a href="../reference/plot_param_evolution.html">plot_param_evolution</a></span><span class="op">(</span><span class="va">var_eigen_paramEvo</span>, scaled<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="advanced-command-line-functions_files/figure-html/unnamed-chunk-14-2.png" width="560"></p>
<p>As we can see, the recommended <em>df</em> can vary widely depending
on the metric selected. <code><a href="../reference/get_eigen_DFoverlay_list.html">get_eigen_DFoverlay_list()</a></code> will
plot all eigen-projections (green points), a manually selected
<em>df</em> (blue line) and automatically fitted <em>df</em> (red line),
while grey lines represent splines at 0.2 <em>df</em> intervals (default
value):</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span>

<span class="co"># plot all eigen-projections</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">arrangeGrob</a></span><span class="op">(</span>grobs<span class="op">=</span><span class="fu"><a href="../reference/get_eigen_DFoverlay_list.html">get_eigen_DFoverlay_list</a></span><span class="op">(</span><span class="va">var_eigen</span>, manualDf <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="advanced-command-line-functions_files/figure-html/unnamed-chunk-15-1.png" width="720">
It should be noted that <em>df=2</em> corresponds to a linear model.
<em>df=number(time-points)</em> corresponds to a curve that will go
through all points (overfitted).</p>
<p>A final factor to take into account is the number of points needed
for each individuals depending on the <em>df</em> selected:</p>
<ul>
<li>the minimum number of time-points needed is the <em>df</em>
</li>
<li>if for example <em>df=10</em>, all individuals that have less than
10 time-points have to be rejected</li>
</ul>
<p>Using <code><a href="../reference/plot_nbTP_histogram.html">plot_nbTP_histogram()</a></code> we can visualise how many
samples would have to be rejected for a given <em>df</em>. Due to the
lack of missing values in the <code>acuteInflammation</code> dataset,
the plots is not very informative.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># dfCutOff controls which cut-off is to be applied</span>
<span class="fu"><a href="../reference/plot_nbTP_histogram.html">plot_nbTP_histogram</a></span><span class="op">(</span><span class="va">var_eigen</span>, dfCutOff<span class="op">=</span><span class="fl">5</span><span class="op">)</span></code></pre></div>
<p><img src="advanced-command-line-functions_files/figure-html/unnamed-chunk-16-1.png" width="560"></p>
<p>As it does not seem to be possible to automatically select the degree
of freedom, a choice based on visualisation of the splines while being
careful of overfitting, keeping in mind the ‘expected’ evolution of the
underlying process is the most sensible approach.</p>
</div>
<div class="section level2">
<h2 id="fitting-confidence-bands-and-plotting">Fitting, Confidence bands and plotting<a class="anchor" aria-label="anchor" href="#fitting-confidence-bands-and-plotting"></a>
</h2>
<p>Fitting of each individual and group mean curves are achieved with
<code><a href="../reference/santaR_fit.html">santaR_fit()</a></code> to generate a <code>SANTAObj</code> that is
then used for processing:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">var1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/santaR_fit.html">santaR_fit</a></span><span class="op">(</span><span class="va">var1_input</span>, df<span class="op">=</span><span class="fl">5</span>, groupin<span class="op">=</span><span class="va">var1_group</span><span class="op">)</span>

<span class="co"># it is possible to access the SANTAObj structure, which will be filled in the following steps</span>
<span class="va">var1</span><span class="op">$</span><span class="va">properties</span></code></pre></div>
<pre><code><span class="co">## $df</span>
<span class="co">## [1] 5</span>
<span class="co">## </span>
<span class="co">## $CBand</span>
<span class="co">## $CBand$status</span>
<span class="co">## [1] FALSE</span>
<span class="co">## </span>
<span class="co">## $CBand$nBoot</span>
<span class="co">## [1] NA</span>
<span class="co">## </span>
<span class="co">## $CBand$alpha</span>
<span class="co">## [1] NA</span>
<span class="co">## </span>
<span class="co">## </span>
<span class="co">## $pval.dist</span>
<span class="co">## $pval.dist$status</span>
<span class="co">## [1] FALSE</span>
<span class="co">## </span>
<span class="co">## $pval.dist$nPerm</span>
<span class="co">## [1] NA</span>
<span class="co">## </span>
<span class="co">## $pval.dist$alpha</span>
<span class="co">## [1] NA</span>
<span class="co">## </span>
<span class="co">## </span>
<span class="co">## $pval.fit</span>
<span class="co">## $pval.fit$status</span>
<span class="co">## [1] FALSE</span>
<span class="co">## </span>
<span class="co">## $pval.fit$nPerm</span>
<span class="co">## [1] NA</span>
<span class="co">## </span>
<span class="co">## $pval.fit$alpha</span>
<span class="co">## [1] NA</span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">var1</span><span class="op">$</span><span class="va">general</span></code></pre></div>
<pre><code><span class="co">## $inputData</span>
<span class="co">##                0           4           8          12          24         48</span>
<span class="co">## ind_1 -0.2178789  0.91102691  0.58499815  1.62075258  0.78381065  0.4986962</span>
<span class="co">## ind_2 -0.2178789  4.19746095 -0.08218860 -0.02869199 -1.03962428 -0.7635814</span>
<span class="co">## ind_3 -0.5115942 -0.01893874 -0.29144117  0.40496659 -0.19688610 -0.2911434</span>
<span class="co">## ind_4 -0.5115942  0.08296167 -0.73976352 -1.03962428 -1.03962428 -1.0396243</span>
<span class="co">## ind_5 -0.3968660  0.03205536 -0.04776568  0.43082440  0.02465099  0.0574394</span>
<span class="co">## ind_6 -0.3968660  1.36463826 -0.52139013 -0.76250288 -1.03962428 -1.0396243</span>
<span class="co">## ind_7 -0.3639912  0.45089171  0.32184021  0.87155065  0.33945976  0.3697976</span>
<span class="co">## ind_8 -0.3639912  1.85844915 -0.41087558 -0.48644857 -1.03962428 -1.0396243</span>
<span class="co">##                72</span>
<span class="co">## ind_1  2.34452908</span>
<span class="co">## ind_2 -0.85939701</span>
<span class="co">## ind_3 -0.07503976</span>
<span class="co">## ind_4 -1.03962428</span>
<span class="co">## ind_5  0.58606071</span>
<span class="co">## ind_6 -1.03962428</span>
<span class="co">## ind_7  1.85572115</span>
<span class="co">## ind_8 -1.03962428</span>
<span class="co">## </span>
<span class="co">## $grouping</span>
<span class="co">##     ind  group</span>
<span class="co">## 1 ind_1 Group1</span>
<span class="co">## 2 ind_2 Group2</span>
<span class="co">## 3 ind_3 Group1</span>
<span class="co">## 4 ind_4 Group2</span>
<span class="co">## 5 ind_5 Group1</span>
<span class="co">## 6 ind_6 Group2</span>
<span class="co">## 7 ind_7 Group1</span>
<span class="co">## 8 ind_8 Group2</span>
<span class="co">## </span>
<span class="co">## $cleanData.in</span>
<span class="co">##                0           4           8          12          24         48</span>
<span class="co">## ind_1 -0.2178789  0.91102691  0.58499815  1.62075258  0.78381065  0.4986962</span>
<span class="co">## ind_3 -0.5115942 -0.01893874 -0.29144117  0.40496659 -0.19688610 -0.2911434</span>
<span class="co">## ind_5 -0.3968660  0.03205536 -0.04776568  0.43082440  0.02465099  0.0574394</span>
<span class="co">## ind_7 -0.3639912  0.45089171  0.32184021  0.87155065  0.33945976  0.3697976</span>
<span class="co">## ind_2 -0.2178789  4.19746095 -0.08218860 -0.02869199 -1.03962428 -0.7635814</span>
<span class="co">## ind_4 -0.5115942  0.08296167 -0.73976352 -1.03962428 -1.03962428 -1.0396243</span>
<span class="co">## ind_6 -0.3968660  1.36463826 -0.52139013 -0.76250288 -1.03962428 -1.0396243</span>
<span class="co">## ind_8 -0.3639912  1.85844915 -0.41087558 -0.48644857 -1.03962428 -1.0396243</span>
<span class="co">##                72</span>
<span class="co">## ind_1  2.34452908</span>
<span class="co">## ind_3 -0.07503976</span>
<span class="co">## ind_5  0.58606071</span>
<span class="co">## ind_7  1.85572115</span>
<span class="co">## ind_2 -0.85939701</span>
<span class="co">## ind_4 -1.03962428</span>
<span class="co">## ind_6 -1.03962428</span>
<span class="co">## ind_8 -1.03962428</span>
<span class="co">## </span>
<span class="co">## $cleanData.pred</span>
<span class="co">##                 0           4           8         12          24         48</span>
<span class="co">## ind_1 -0.03040631  0.56124885  0.98284290  1.2842945  0.88191298  0.5113377</span>
<span class="co">## ind_3 -0.43772801 -0.19221430 -0.00594887  0.1514541 -0.12285555 -0.2973872</span>
<span class="co">## ind_5 -0.33467888 -0.08003787  0.11733113  0.2624271  0.08162091  0.0552708</span>
<span class="co">## ind_7 -0.21917438  0.21856919  0.51666059  0.6967476  0.40689485  0.3762108</span>
<span class="co">## ind_2  1.07199235  1.61234822  1.02168852  0.1965878 -1.05205157 -0.7907262</span>
<span class="co">## ind_4 -0.29375553 -0.36253199 -0.62036975 -0.8914169 -1.07972622 -1.0396064</span>
<span class="co">## ind_6  0.15268214  0.25972467 -0.11432853 -0.5697866 -1.07954149 -1.0451341</span>
<span class="co">## ind_8  0.30394968  0.51680619  0.14463497 -0.3414922 -1.05732947 -1.0504671</span>
<span class="co">##                72</span>
<span class="co">## ind_1  2.33470416</span>
<span class="co">## ind_3 -0.07539689</span>
<span class="co">## ind_5  0.58446600</span>
<span class="co">## ind_7  1.84936123</span>
<span class="co">## ind_2 -0.85374035</span>
<span class="co">## ind_4 -1.03948646</span>
<span class="co">## ind_6 -1.03860966</span>
<span class="co">## ind_8 -1.03784104</span>
<span class="co">## </span>
<span class="co">## $pval.curveCorr</span>
<span class="co">## [1] NA</span>
<span class="co">## </span>
<span class="co">## $pval.dist</span>
<span class="co">## [1] NA</span>
<span class="co">## </span>
<span class="co">## $pval.dist.l</span>
<span class="co">## [1] NA</span>
<span class="co">## </span>
<span class="co">## $pval.dist.u</span>
<span class="co">## [1] NA</span>
<span class="co">## </span>
<span class="co">## $pval.fit</span>
<span class="co">## [1] NA</span>
<span class="co">## </span>
<span class="co">## $pval.fit.l</span>
<span class="co">## [1] NA</span>
<span class="co">## </span>
<span class="co">## $pval.fit.u</span>
<span class="co">## [1] NA</span>
<span class="co">## </span>
<span class="co">## $meanCurve</span>
<span class="co">## Call:</span>
<span class="co">## stats::smooth.spline(x = time[notNA], y = meanVal[notNA], df = sum(notNA))</span>
<span class="co">## </span>
<span class="co">## Smoothing Parameter  spar= -0.7565504  lambda= 6.486837e-13 (21 iterations)</span>
<span class="co">## Equivalent Degrees of Freedom (Df): 7</span>
<span class="co">## Penalized Criterion (RSS): 2.358641e-17</span>
<span class="co">## GCV: 0.03087262</span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">var1</span><span class="op">$</span><span class="va">groups</span><span class="op">$</span><span class="va">Group1</span></code></pre></div>
<pre><code><span class="co">## $rejectedInd</span>
<span class="co">## list()</span>
<span class="co">## </span>
<span class="co">## $curveInd</span>
<span class="co">## $curveInd$ind_1</span>
<span class="co">## Call:</span>
<span class="co">## stats::smooth.spline(x = xInd, y = yInd, df = df)</span>
<span class="co">## </span>
<span class="co">## Smoothing Parameter  spar= 0.3926483  lambda= 0.0001303627 (10 iterations)</span>
<span class="co">## Equivalent Degrees of Freedom (Df): 4.999723</span>
<span class="co">## Penalized Criterion (RSS): 0.4388556</span>
<span class="co">## GCV: 0.7677847</span>
<span class="co">## </span>
<span class="co">## $curveInd$ind_3</span>
<span class="co">## Call:</span>
<span class="co">## stats::smooth.spline(x = xInd, y = yInd, df = df)</span>
<span class="co">## </span>
<span class="co">## Smoothing Parameter  spar= 0.3926483  lambda= 0.0001303627 (10 iterations)</span>
<span class="co">## Equivalent Degrees of Freedom (Df): 4.999723</span>
<span class="co">## Penalized Criterion (RSS): 0.1867747</span>
<span class="co">## GCV: 0.3267653</span>
<span class="co">## </span>
<span class="co">## $curveInd$ind_5</span>
<span class="co">## Call:</span>
<span class="co">## stats::smooth.spline(x = xInd, y = yInd, df = df)</span>
<span class="co">## </span>
<span class="co">## Smoothing Parameter  spar= 0.3926483  lambda= 0.0001303627 (10 iterations)</span>
<span class="co">## Equivalent Degrees of Freedom (Df): 4.999723</span>
<span class="co">## Penalized Criterion (RSS): 0.07529958</span>
<span class="co">## GCV: 0.1317378</span>
<span class="co">## </span>
<span class="co">## $curveInd$ind_7</span>
<span class="co">## Call:</span>
<span class="co">## stats::smooth.spline(x = xInd, y = yInd, df = df)</span>
<span class="co">## </span>
<span class="co">## Smoothing Parameter  spar= 0.3926483  lambda= 0.0001303627 (10 iterations)</span>
<span class="co">## Equivalent Degrees of Freedom (Df): 4.999723</span>
<span class="co">## Penalized Criterion (RSS): 0.1480858</span>
<span class="co">## GCV: 0.2590785</span>
<span class="co">## </span>
<span class="co">## </span>
<span class="co">## $groupMeanCurve</span>
<span class="co">## Call:</span>
<span class="co">## stats::smooth.spline(x = time[notNA], y = meanVal[notNA], df = sum(notNA))</span>
<span class="co">## </span>
<span class="co">## Smoothing Parameter  spar= -0.7565504  lambda= 6.486837e-13 (21 iterations)</span>
<span class="co">## Equivalent Degrees of Freedom (Df): 7</span>
<span class="co">## Penalized Criterion (RSS): 4.67263e-18</span>
<span class="co">## GCV: 0.006116077</span>
<span class="co">## </span>
<span class="co">## $point.in</span>
<span class="co">##     x           y</span>
<span class="co">## 1   0 -0.21787887</span>
<span class="co">## 2   4  0.91102691</span>
<span class="co">## 3   8  0.58499815</span>
<span class="co">## 4  12  1.62075258</span>
<span class="co">## 5  24  0.78381065</span>
<span class="co">## 6  48  0.49869622</span>
<span class="co">## 7  72  2.34452908</span>
<span class="co">## 8   0 -0.51159424</span>
<span class="co">## 9   4 -0.01893874</span>
<span class="co">## 10  8 -0.29144117</span>
<span class="co">## 11 12  0.40496659</span>
<span class="co">## 12 24 -0.19688610</span>
<span class="co">## 13 48 -0.29114335</span>
<span class="co">## 14 72 -0.07503976</span>
<span class="co">## 15  0 -0.39686603</span>
<span class="co">## 16  4  0.03205536</span>
<span class="co">## 17  8 -0.04776568</span>
<span class="co">## 18 12  0.43082440</span>
<span class="co">## 19 24  0.02465099</span>
<span class="co">## 20 48  0.05743940</span>
<span class="co">## 21 72  0.58606071</span>
<span class="co">## 22  0 -0.36399116</span>
<span class="co">## 23  4  0.45089171</span>
<span class="co">## 24  8  0.32184021</span>
<span class="co">## 25 12  0.87155065</span>
<span class="co">## 26 24  0.33945976</span>
<span class="co">## 27 48  0.36979758</span>
<span class="co">## 28 72  1.85572115</span>
<span class="co">## </span>
<span class="co">## $point.pred</span>
<span class="co">##     x           y</span>
<span class="co">## 1   0 -0.03040631</span>
<span class="co">## 2   4  0.56124885</span>
<span class="co">## 3   8  0.98284290</span>
<span class="co">## 4  12  1.28429446</span>
<span class="co">## 5  24  0.88191298</span>
<span class="co">## 6  48  0.51133768</span>
<span class="co">## 7  72  2.33470416</span>
<span class="co">## 8   0 -0.43772801</span>
<span class="co">## 9   4 -0.19221430</span>
<span class="co">## 10  8 -0.00594887</span>
<span class="co">## 11 12  0.15145407</span>
<span class="co">## 12 24 -0.12285555</span>
<span class="co">## 13 48 -0.29738722</span>
<span class="co">## 14 72 -0.07539689</span>
<span class="co">## 15  0 -0.33467888</span>
<span class="co">## 16  4 -0.08003787</span>
<span class="co">## 17  8  0.11733113</span>
<span class="co">## 18 12  0.26242705</span>
<span class="co">## 19 24  0.08162091</span>
<span class="co">## 20 48  0.05527080</span>
<span class="co">## 21 72  0.58446600</span>
<span class="co">## 22  0 -0.21917438</span>
<span class="co">## 23  4  0.21856919</span>
<span class="co">## 24  8  0.51666059</span>
<span class="co">## 25 12  0.69674758</span>
<span class="co">## 26 24  0.40689485</span>
<span class="co">## 27 48  0.37621084</span>
<span class="co">## 28 72  1.84936123</span>
<span class="co">## </span>
<span class="co">## $groupData.in</span>
<span class="co">##                0           4           8        12          24         48</span>
<span class="co">## ind_1 -0.2178789  0.91102691  0.58499815 1.6207526  0.78381065  0.4986962</span>
<span class="co">## ind_3 -0.5115942 -0.01893874 -0.29144117 0.4049666 -0.19688610 -0.2911434</span>
<span class="co">## ind_5 -0.3968660  0.03205536 -0.04776568 0.4308244  0.02465099  0.0574394</span>
<span class="co">## ind_7 -0.3639912  0.45089171  0.32184021 0.8715506  0.33945976  0.3697976</span>
<span class="co">##                72</span>
<span class="co">## ind_1  2.34452908</span>
<span class="co">## ind_3 -0.07503976</span>
<span class="co">## ind_5  0.58606071</span>
<span class="co">## ind_7  1.85572115</span>
<span class="co">## </span>
<span class="co">## $groupData.pred</span>
<span class="co">##                 0           4           8        12          24         48</span>
<span class="co">## ind_1 -0.03040631  0.56124885  0.98284290 1.2842945  0.88191298  0.5113377</span>
<span class="co">## ind_3 -0.43772801 -0.19221430 -0.00594887 0.1514541 -0.12285555 -0.2973872</span>
<span class="co">## ind_5 -0.33467888 -0.08003787  0.11733113 0.2624271  0.08162091  0.0552708</span>
<span class="co">## ind_7 -0.21917438  0.21856919  0.51666059 0.6967476  0.40689485  0.3762108</span>
<span class="co">##                72</span>
<span class="co">## ind_1  2.33470416</span>
<span class="co">## ind_3 -0.07539689</span>
<span class="co">## ind_5  0.58446600</span>
<span class="co">## ind_7  1.84936123</span></code></pre>
<p>Confidence bands on the group mean curves can be calculated by
bootstrapping using <code><a href="../reference/santaR_CBand.html">santaR_CBand()</a></code>:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">var1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/santaR_CBand.html">santaR_CBand</a></span><span class="op">(</span><span class="va">var1</span><span class="op">)</span></code></pre></div>
<p>Plot is achieved using <code><a href="../reference/santaR_plot.html">santaR_plot()</a></code>, for more details
see <a href="plotting-options.html">Plotting options</a>:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/santaR_plot.html">santaR_plot</a></span><span class="op">(</span><span class="va">var1</span><span class="op">)</span></code></pre></div>
<p><img src="advanced-command-line-functions_files/figure-html/unnamed-chunk-19-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="p-values-calculation">P-values calculation<a class="anchor" aria-label="anchor" href="#p-values-calculation"></a>
</h2>
<p>The <em>p</em>-values are calculated by the comparison of distance
between group mean curves by random sampling of individuals. Due to the
stochastic nature of the test, the <em>p</em>-value obtained can
slighlty vary depending on the random draw. This can be compounded by
using the lower and upper confidence range on the <em>p</em>-value that
is estimated at the same time.</p>
<p><code><a href="../reference/santaR_pvalue_dist.html">santaR_pvalue_dist()</a></code> will calculate the significance of
the difference between two groups:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">var1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/santaR_pvalue_dist.html">santaR_pvalue_dist</a></span><span class="op">(</span><span class="va">var1</span><span class="op">)</span>
<span class="co"># p-value</span>
<span class="va">var1</span><span class="op">$</span><span class="va">general</span><span class="op">$</span><span class="va">pval.dist</span></code></pre></div>
<pre><code><span class="co">## [1] 0.00999001</span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># lower p-value confidence range</span>
<span class="va">var1</span><span class="op">$</span><span class="va">general</span><span class="op">$</span><span class="va">pval.dist.l</span></code></pre></div>
<pre><code><span class="co">## [1] 0.005433704</span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># upper p-value confidence range</span>
<span class="va">var1</span><span class="op">$</span><span class="va">general</span><span class="op">$</span><span class="va">pval.dist.u</span></code></pre></div>
<pre><code><span class="co">## [1] 0.01829662</span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># curve correlation coefficiant</span>
<span class="va">var1</span><span class="op">$</span><span class="va">general</span><span class="op">$</span><span class="va">pval.curveCorr</span></code></pre></div>
<pre><code><span class="co">## [1] -0.1309867</span></code></pre>
</div>
<div class="section level2">
<h2 id="see-also">See Also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h2>
<ul>
<li><a href="getting-started.html">Getting Started with santaR</a></li>
<li><a href="prepare-input-data.html">How to prepare input data for
santaR</a></li>
<li><a href="theoretical-background.html">santaR theoretical
background</a></li>
<li><a href="santaR-GUI.pdf">Graphical user interface use</a></li>
<li><a href="automated-command-line.html">Automated command line
analysis</a></li>
<li><a href="plotting-options.html">Plotting options</a></li>
<li><a href="selecting-optimal-df.html">Selecting an optimal number of
degrees of freedom</a></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Arnaud Wolfer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
