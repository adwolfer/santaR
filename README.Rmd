---
output: github_document
---

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```
<!-- README.md is generated from README.Rmd. Please edit that file -->

# santaR
[![Build Status](https://travis-ci.org/adwolfer/santaR.svg?branch=develop)](https://travis-ci.org/adwolfer/santaR) [![codecov](https://codecov.io/gh/adwolfer/santaR/branch/develop/graph/badge.svg)](https://codecov.io/gh/adwolfer/santaR/branch/develop) [![CRAN\_Status\_Badge](http://www.r-pkg.org/badges/version/santaR)](https://cran.r-project.org/package=santaR)

Interactive package for _Short AsyNchronous Time-series Analysis_ (SANTA), implemented in `R` and `Shiny`

## Overview

Longitudinal studies in Systems Biology face multiple challenges that are not suitably addressed by current time-series statistical methods: it is difficult to simultaneously account for _biological variability_, _measurement error_, _missing observations_, _asynchronous sampling_, _nonlinearity_ and _low number of time points_ (e.g. 4-10) with a _high number of variables_.

To address these challenges, `santaR` (_Short AsyNchronous Time-series Analysis_) provides a Functional Data Analysis (_FDA_) approach -_where the fundamental units of analysis are curves representing each individual across time_-, in a graphical and automated pipeline for robust analysis of short time-series studies. 

Analytes levels are descriptive of the underlying biological state and evolve smoothly through time. For a single analyte, the time trajectory of each individual is described with a smooth curve estimated by smoothing splines. For a group of individuals, a curve representing the group mean trajectory is also calculated. These individual and group mean curves become the new observational unit for subsequent data analysis, that is, the estimation of the intra-class variability and the identification of trajectories significantly altered between groups. 

Designed initially for metabolomic, `santaR` is also suited for other Systems Biology disciplines. Implemented in `R` and `Shiny`, `santaR` is developed as a complete and easy-to-use statistical software package, which enables command line and GUI analysis, with fast and parallel automated analysis and reporting. Comprehensive plotting options as well as automated summaries allow clear identification of significantly altered analytes for non-specialist users.

![](man/figures/santaR-approach.jpg)

## Installation

`santaR` can directly be installed from CRAN with:
```{r, eval = FALSE}
install.packages("santaR")
```

A development version can be obtained from GitHub with:
```{r, eval = FALSE}
# Install devtools
if(!require("devtools")) install.packages("devtools")
devtools::install_github("adwolfer/santaR", ref="develop")
```

If the dependency `pcaMethods` is not successfully installed, `Bioconductor` must be added to the default repositories with:
```{r, eval = FALSE}
setRepositories(ind=c(1:5))
```


## Usage

To get started `santaR`'s graphical user interface implements all the functions for short asynchronous time-series analysis:
```{r, eval = FALSE}
library(santaR)

santaR_start_GUI(browser = TRUE)
#  To exit press ESC in the command line
```
The graphical user interface is divided in 4 sections, corresponding to the main steps of analysis:

**Import**, **DF search**, **Analysis** and **Export**:

* The **Import** tab manages input data in comma separated value (_csv_) format or as an _RData_ file containing a previous analysis. Once data is imported the **DF search** and **Analysis** tabs become available.
* **DF search** implements the tools for the selection of an optimal number of degrees of freedom (_df_).
* With the data imported and a pertinent _df_ selected, **Analysis** regroups the interface to visualise and identify variables significantly altered over time. A plotting interface enables the interactive visualisation of the raw data points, individual trajectories, group mean curves and confidence bands for all variables, which subsequently can be saved. Finally, if inter-group differential trajectories have been characterised, all significance testing results (with correction for multiple testing) are presented in interactive tables.
* The **Export** tab manages the saving of results and automated reporting. Fitted data can be saved as an _RData_ file for future analysis or reproduction of results. _csv_ tables containing significance testing results can also be generated and summary plot for each significantly altered variable saved for rapid evaluation.

![](man/figures/README-example-1.png)

## Vignettes and Demo data

More information is available in the graphical user interface as well as in the following vignettes:

* [Getting Started with santaR](http://htmlpreview.github.io/?https://github.com/adwolfer/santaR/blob/develop/doc/getting-started.html)
* [How to prepare input data for santaR](http://htmlpreview.github.io/?https://github.com/adwolfer/santaR/blob/develop/doc/prepare-input-data.html)
* [santaR Graphical user interface use](doc/santaR-GUI.pdf)
* [santaR Theoretical Background](http://htmlpreview.github.io/?https://github.com/adwolfer/santaR/blob/develop/doc/theoretical-background.html)
* [Automated command line analysis](http://htmlpreview.github.io/?https://github.com/adwolfer/santaR/blob/develop/doc/automated-command-line.html)
* [Plotting options](http://htmlpreview.github.io/?https://github.com/adwolfer/santaR/blob/develop/doc/plotting-options.html)
* [Selecting an optimal number of degrees of freedom](http://htmlpreview.github.io/?https://github.com/adwolfer/santaR/blob/develop/doc/selecting-optimal-df.html)
* [Advanced command line options](http://htmlpreview.github.io/?https://github.com/adwolfer/santaR/blob/develop/doc/advanced-command-line-functions.html)

A dataset containing the concentrations of 22 mediators of inflammation over an episode of acute inflammation is also available. The mediators have been measured at 7 time-points on 8 subjects, concentration values have been unit-variance scaled for each variable. A subset of the data is presented below:
```{r, eval = FALSE}
## Metadata
acuteInflammation$meta
```
```{r, results = "asis", echo = FALSE}
library(santaR)
tmpDF <- acuteInflammation$meta[14:19,]
rownames(tmpDF) <- NULL
pander::pandoc.table(tmpDF)
```
```{r, eval = FALSE}
## Data
acuteInflammation$data
```
```{r, results = "asis", echo = FALSE}
library(santaR)
tmpDF <- acuteInflammation$data[14:19,1:4]
rownames(tmpDF) <- NULL
pander::pandoc.table(tmpDF)
```


## Other tips

The GUI is to be prefered to understand the methodology, select the best parameters on a subset of the data before running the command line, or to visually explore results.

If a very high number of variables is to be processed, `santaR`'s command line functions are more efficient, as they can be integrated in scripts and the reporting automated.


## Copyright

`santaR` is licensed under the [GPLv3](http://choosealicense.com/licenses/gpl-3.0/)

As a summary, the GPLv3 license requires attribution, inclusion of copyright and license information, disclosure of source code and changes. Derivative work must be available under the same terms.

&copy; Arnaud Wolfer (2019)


